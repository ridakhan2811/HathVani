<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hathvani Sign Language Interface</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --deep-blue: #0A192F;
      --cool-gray: #E8E8E8;
      --soft-white: #F0F8FF;
      --bright-teal: #42C2FF;
      --card-bg: rgba(255, 255, 255, 0.05);
    }
    body {
      font-family: 'Poppins', sans-serif;
      background: var(--deep-blue);
      color: var(--soft-white);
      animation: fadeIn 1.5s ease-in-out;
      display: flex;
      flex-direction: column;
      min-height: 100vh; /* Ensures footer stays at the bottom */
      margin: 0;
    }

    /* Header/Footer styling */
    .header-footer-bg {
      background: rgba(10, 25, 47, 0.9);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid rgba(66, 194, 255, 0.2);
    }

    /* Main content container */
    main {
      flex: 1; /* Pushes footer to the bottom */
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem;
    }
    
    /* Background animation */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 50% 50%, rgba(66, 194, 255, 0.1) 0%, rgba(10, 25, 47, 0) 60%);
      z-index: -1;
      animation: pulseBackground 10s infinite alternate ease-in-out;
    }

    /* Main content container styling */
    .cyber-container {
      width: 100%;
      max-width: 900px;
      animation: popIn 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    /* Card styling with glowing border */
    .cyber-card {
      background: var(--card-bg);
      backdrop-filter: blur(8px);
      border: 2px solid rgba(66, 194, 255, 0.2);
      border-radius: 1.5rem;
      box-shadow: 0 0 20px rgba(66, 194, 255, 0.1);
      transition: all 0.5s ease;
    }

    .cyber-card:hover {
      border-color: var(--bright-teal);
      box-shadow: 0 0 30px var(--bright-teal);
      transform: translateY(-5px) scale(1.01);
    }

    /* Video element styling */
    #video {
      border: 3px solid var(--bright-teal);
      border-radius: 1.25rem;
      box-shadow: 0 0 15px var(--bright-teal), 0 0 30px rgba(66, 194, 255, 0.5);
      transition: all 0.5s ease;
      animation: shimmer 2s infinite ease-in-out;
    }
    #video:hover {
      transform: scale(1.02);
      box-shadow: 0 0 20px var(--bright-teal), 0 0 40px rgba(66, 194, 255, 0.8);
    }

    /* Title text styling */
    .title-text {
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      background-image: linear-gradient(90deg, var(--soft-white), var(--bright-teal));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: text-glow 3s infinite alternate ease-in-out;
    }

    /* Animated Prediction text */
    .prediction-text {
      animation: resultPop 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    }

    /* Keyframe Animations */
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes pulseBackground {
      0% { transform: scale(1); }
      100% { transform: scale(1.1); }
    }
    @keyframes popIn {
      from { transform: scale(0.95); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    @keyframes shimmer {
      0% { box-shadow: 0 0 15px var(--bright-teal), 0 0 30px rgba(66, 194, 255, 0.5); }
      50% { box-shadow: 0 0 20px var(--bright-teal), 0 0 40px rgba(66, 194, 255, 0.7); }
      100% { box-shadow: 0 0 15px var(--bright-teal), 0 0 30px rgba(66, 194, 255, 0.5); }
    }
    @keyframes text-glow {
      0% { text-shadow: 0 0 5px var(--bright-teal), 0 0 10px var(--soft-white); }
      50% { text-shadow: 0 0 10px var(--bright-teal), 0 0 20px var(--bright-teal); }
      100% { text-shadow: 0 0 5px var(--soft-white), 0 0 10px var(--bright-teal); }
    }
    @keyframes resultPop {
      0% { transform: scale(0.8); opacity: 0; }
      80% { transform: scale(1.1); opacity: 1; }
      100% { transform: scale(1); }
    }
  </style>
</head>
<body>
  
  <!-- Header -->
  <header class="header-footer-bg text-cool-gray sticky top-0 z-50">
    <nav class="flex justify-between items-center max-w-7xl mx-auto p-4">
      <div class="flex items-center space-x-2">
        <h1 class="text-3xl font-extrabold title-text">HATHVANI</h1>
      </div>
      <div class="space-x-4">
        <a href="#" class="text-cool-gray hover:text-bright-teal transition-colors">Home</a>
        <a href="#" class="text-cool-gray hover:text-bright-teal transition-colors">About</a>
        <a href="#" class="text-cool-gray hover:text-bright-teal transition-colors">Contact</a>
      </div>
    </nav>
  </header>

  <!-- Main Content -->
  <main>
    <div class="cyber-container flex flex-col items-center space-y-8">
      <!-- Combined Title and One-Liner -->
      <h1 class="text-5xl font-extrabold title-text text-center mt-4">
        ‚úã HATHVANI: From Sign To Speech üó£Ô∏è
      </h1>

      <!-- Live Camera Preview Card -->
      <div class="cyber-card p-6 w-full text-center">
        <p class="text-md text-gray-400 mb-4 animate-pulse">
          <span class="text-bright-teal">SYSTEM ONLINE:</span> Awaiting sign input...
        </p>
        <video id="video" width="400" height="300" autoplay muted class="mx-auto block"></video>
      </div>

      <!-- Prediction Results Card -->
      <div class="cyber-card p-8 w-full text-center">
        <h2 class="text-3xl font-bold mb-4 text-bright-teal">TRANSLATION LOG</h2>
        <div id="signOutput" class="text-4xl font-extrabold mb-4">
          <span class="text-bright-teal">‚úã Sign:</span> <span class="prediction-text text-cool-gray">---</span>
        </div>
        <div id="marathiOutput" class="text-3xl font-extrabold">
          <span class="text-bright-teal">üó£Ô∏è Marathi:</span> <span class="prediction-text text-cool-gray">---</span>
        </div>
      </div>
      
      <!-- Placeholder Cards to demonstrate scrolling -->
      <div class="cyber-card p-8 w-full text-center mt-8">
        <h2 class="text-3xl font-bold mb-4 text-bright-teal">SCROLL DEMONSTRATION</h2>
        <p class="text-xl text-cool-gray">This is a placeholder card to make the page long enough to scroll.</p>
      </div>
      
      <div class="cyber-card p-8 w-full text-center mt-8">
        <h2 class="text-3xl font-bold mb-4 text-bright-teal">MORE CONTENT</h2>
        <p class="text-xl text-cool-gray">You can add more features and information here, and the page will now scroll to accommodate it.</p>
      </div>
    </div>
  </main>
  
  <!-- Footer -->
  <footer class="header-footer-bg text-cool-gray text-center p-4 mt-8">
    <p>&copy; 2024 Hathvani. All rights reserved.</p>
  </footer>

  <!-- Real-time Prediction Script -->
  <script>
    const video = document.getElementById('video');
    const signOutput = document.getElementById('signOutput');
    const marathiOutput = document.getElementById('marathiOutput');
    let lastPrediction = "";

    // Function to update output with animated effects
    function updateOutput(data) {
      // Find the spans to animate
      const signText = signOutput.querySelector('.prediction-text');
      const marathiText = marathiOutput.querySelector('.prediction-text');

      // Add animation classes
      signText.classList.remove('prediction-text');
      marathiText.classList.remove('prediction-text');
      void signText.offsetWidth; // Trigger reflow
      void marathiText.offsetWidth; // Trigger reflow
      signText.classList.add('prediction-text');
      marathiText.classList.add('prediction-text');

      // Update text content
      setTimeout(() => {
        signText.textContent = data.prediction;
        marathiText.textContent = data.marathi;
      }, 100);

      // Play audio if available
      if (data.audio_url) {
        const audio = new Audio(data.audio_url);
        audio.play();
      }
    }

    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => video.srcObject = stream)
      .catch(err => console.error("Webcam error:", err));

    function captureFrameAndSend() {
      const canvas = document.createElement('canvas');
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      canvas.getContext('2d').drawImage(video, 0, 0);
      canvas.toBlob(blob => {
        const formData = new FormData();
        formData.append('image', blob, 'frame.jpg');
        fetch('/predict/', {
          method: 'POST',
          body: formData,
          headers: { 'X-CSRFToken': '{{ csrf_token }}' }
        })
        .then(res => res.json())
        .then(data => {
          if (data.prediction && data.prediction !== lastPrediction) {
            lastPrediction = data.prediction;
            updateOutput(data);
          }
        })
        .catch(err => console.error('Prediction error:', err));
      }, 'image/jpeg');
    }

    setInterval(captureFrameAndSend, 2000); // every 2 seconds
  </script>
</body>
</html>
